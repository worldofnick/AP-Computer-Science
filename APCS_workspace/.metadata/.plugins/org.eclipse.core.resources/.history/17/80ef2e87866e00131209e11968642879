

public class Spreadsheet {
	// Nick Porter
		private Cell[][] rowsAndColumns;
		private int numberOfColumns;
		private int numberOfRows;
		private int cellWidth = 12;

	Spreadsheet(int numOfRows, int numOfColumns) {
		rowsAndColumns = new Cell[numOfRows][numOfColumns];
		
		setNumberOfRows(numOfRows);
		setNumberOfColumns(numOfColumns);
		
		for (int column = 0; column < numOfRows; column++) {	
			for (int row = 0; row < numOfColumns; row++) {
				// Initializes all cells to an empty state.
				rowsAndColumns[column][row] = new Cell();
			}
		}
	}
	
	public void print() {
		// Add one to numberOfColumns to account for the header/number rows and columns.
		// *START HEADER*
		printDashes();
		//System.out.printf("|%12s|", "");
		System.out.print("|");
		System.out.print(String.format("%1$" + cellWidth + "s", "|"));
		for (int i = 0; i < numberOfColumns; i++) {
			// Add 65 to get the int cast to a char
			//System.out.printf("%12c|", (char) i + 65);
			System.out.print(String.format("%1$" + cellWidth + "c|", (char) i + 65));
		}
		
		for (int i = 0; i < numberOfRows; i++) {
			System.out.println();
			printDashes();
			//System.out.printf("|%12d|", i + 1);
			System.out.print("|");
			int newCellWidth = cellWidth - 1;
			System.out.print(String.format("%1$" + newCellWidth + "d|", i + 1));
			// *END HEADER*
			for (int j = 0; j < numberOfColumns; j++) {
				System.out.printf("%s|", rowsAndColumns[i][j].padLeft(cellWidth));
			}
			
		}
		
		System.out.println();
		printDashes();
		 
	}

	private void printDashes() {
		String dashes = "-";
		for(int i = 0; i < cellWidth; i++) {
			dashes += "-";
		}
		
		for (int i = 0; i < numberOfColumns + 1; i++) {
			System.out.print(dashes);
		}
		System.out.println();
	}
	
	public void assignValues(String cell, String cellValue) {
		int letterIndex = getRowFromCellName(cell);
		int rowIndex = getColumnFromCellName(cell);
		boolean operators = rowsAndColumns[rowIndex][letterIndex].checkForOperators(cellValue);
		
		cellValue = checkForCellAssign(cellValue, operators);
		
		 if (cellValue.matches(".*\\d.*") || operators) {
			
			rowsAndColumns[rowIndex][letterIndex].setCellNumericValue(cellValue);
			
			if (rowsAndColumns[rowIndex][letterIndex].toString().length() > cellWidth) {
				cellWidth = rowsAndColumns[rowIndex][letterIndex].toString().length();
			}
			
		} else {
			
			rowsAndColumns[rowIndex][letterIndex].setCellStringValue(cellValue);
			
			if (rowsAndColumns[rowIndex][letterIndex].toString().length() > cellWidth) {
				cellWidth = rowsAndColumns[rowIndex][letterIndex].toString().length();
			}
		} 
		
		print();
		
	}
	
	// Converts a char to int to get index in array.
	public int getRowFromCellName(String cell) {
			cell = cell.toLowerCase();
			char cellLetter = cell.charAt(0);
			int letterIndex = cellLetter - '0' - 49;
			return letterIndex;
	}
		// Finds the index of the row, to match up with the array.
	public int getColumnFromCellName(String cell) {
			int rowNumber = Integer.parseInt(cell.substring(1)) - 1;
			return rowNumber;
	}
	
	public void printHelp() {
		System.out.println("Example Input");
		System.out.println("b5 = 789.6");
		System.out.println("c7 = b5");
	}
	
	/*
	 * Goes through each token of the string and checks if they are assigning to a cell.
	 * If they are it will change the cellID to its value.
	 * Ex: b3 = 12
	 * a1 = 33 + b3
	 * Returns 33 + 12
	 */
	public String checkForCellAssign(String cellValue, boolean isNumber) {
		String[] tokens = cellValue.split(" ");
		String convertedValue = "";
		boolean cellAssign = false;
		for (int i = 0; i < tokens.length; i++) {
			
			// First tests if the first char is a letter.
			// Second tests if the rest of the string is a numeric value.
			if (tokens[i].substring(0, 1).matches("[a-zA-Z]+") &&
				tokens[i].substring(1).matches("\\d+")) {
				
				cellAssign = true;
				int letterIndexAssign = getRowFromCellName(tokens[i]);
				int rowNumberIndexAssign = getColumnFromCellName(tokens[i]);
				if (isNumber) {
					
					tokens[i] = 
							rowsAndColumns[rowNumberIndexAssign][letterIndexAssign].getMathValue();
					
				} else {
					tokens[i] = 
						rowsAndColumns[rowNumberIndexAssign][letterIndexAssign].getCellStringValue();
				}
				
				
			} 	
				
		}
		
		if (cellAssign) {
			
			for (int i = 0; i < tokens.length; i++) {
				convertedValue += tokens[i] + " ";
			}
			return convertedValue;
		} else {
			return cellValue;
		}
		
	}

	public Cell[][] getRowsAndColumns() {
		return rowsAndColumns;
	}

	public void setRowsAndColumns(Cell[][] rowsAndColumns) {
		this.rowsAndColumns = rowsAndColumns;
	}

	public int getNumberOfColumns() {
		return numberOfColumns;
	}

	public void setNumberOfColumns(int numberOfColumns) {
		this.numberOfColumns = numberOfColumns;
	}

	public int getNumberOfRows() {
		return numberOfRows;
	}

	public void setNumberOfRows(int numberOfRows) {
		this.numberOfRows = numberOfRows;
	}
	
	
	
}
